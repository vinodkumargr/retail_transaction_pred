[2023-05-24 21:41:19,844] root - INFO - printing dict data : {'database_name': 'online_retail', 'collection_name': 'online_retail', 'data_ingestion_dir': '/home/vinod/projects/retail_transaction_pred/artifacts/data_ingestion', 'feature_store_path': '/home/vinod/projects/retail_transaction_pred/Online Retail.csv', 'train_file_path': '/home/vinod/projects/retail_transaction_pred/artifacts/data_ingestion/data_split/train.csv', 'test_file_path': '/home/vinod/projects/retail_transaction_pred/artifacts/data_ingestion/data_split/test.csv'}
[2023-05-24 21:41:19,844] root - INFO - Starting data ingestion
[2023-05-24 21:41:20,509] root - INFO - got data from mongodb
[2023-05-24 21:41:20,509] root - INFO - creating feature store dir
[2023-05-24 21:41:20,509] root - INFO - storing into feature store dir
[2023-05-24 21:41:22,255] root - INFO - spliting data into train and test
[2023-05-24 21:41:22,367] root - INFO - create dataset_dir if not exist
[2023-05-24 21:41:22,367] root - INFO - save dataset to feature store after split
[2023-05-24 21:41:24,001] root - INFO - data validation started........
[2023-05-24 21:41:25,355] root - INFO - dropping null values in base_df, axsi-0 and df shape is : (541909, 8)
[2023-05-24 21:41:25,569] root - INFO - now shape of df : (540455, 8)
[2023-05-24 21:41:25,569] root - INFO - columns : Index(['InvoiceNo', 'StockCode', 'Description', 'Quantity', 'InvoiceDate',
       'UnitPrice', 'CustomerID', 'Country'],
      dtype='object')
[2023-05-24 21:41:25,575] root - INFO - dropping null values in train and test df, axis-0
[2023-05-24 21:41:25,785] root - INFO - now shape of df : (540455, 8)
[2023-05-24 21:41:25,785] root - INFO - columns : Index(['InvoiceNo', 'StockCode', 'Description', 'Quantity', 'InvoiceDate',
       'UnitPrice', 'CustomerID', 'Country'],
      dtype='object')
[2023-05-24 21:41:25,989] root - INFO - now shape of df : (540455, 8)
[2023-05-24 21:41:25,990] root - INFO - columns : Index(['InvoiceNo', 'StockCode', 'Description', 'Quantity', 'InvoiceDate',
       'UnitPrice', 'CustomerID', 'Country'],
      dtype='object')
[2023-05-24 21:41:25,995] root - INFO - dropped null values, axis=0 train_df .shape = (540455, 8) , test_df.shape = (540455, 8)
[2023-05-24 21:41:25,995] root - INFO - ____________________dropping unwanted cols, axis=1_________________________
[2023-05-24 21:41:25,995] root - INFO - dropping null values in base_df, axsi-0 and df shape is : (540455, 8)
[2023-05-24 21:41:25,995] root - INFO - found unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,005] root - INFO - dropped unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,005] root - INFO - data shape: (540455, 5)
[2023-05-24 21:41:26,011] root - INFO - dropping null values in train and test df, axis-0
[2023-05-24 21:41:26,011] root - INFO - found unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,020] root - INFO - dropped unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,021] root - INFO - data shape: (540455, 5)
[2023-05-24 21:41:26,026] root - INFO - found unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,036] root - INFO - dropped unwanted columns: ['InvoiceNo', 'StockCode', 'CustomerID']
[2023-05-24 21:41:26,036] root - INFO - data shape: (540455, 5)
[2023-05-24 21:41:26,041] root - INFO - dropped unwanted cols in train and test train_df .shape = (540455, 5) , test_df.shape = (540455, 5)
[2023-05-24 21:41:26,041] root - INFO - ____________________dropping rows on condition(outliers), axis=1_________________________
[2023-05-24 21:41:26,041] root - INFO - dropping rows on condition in base_df and df shape is : (540455, 5)
[2023-05-24 21:41:26,328] root - INFO - dropped null values in base_df
[2023-05-24 21:41:26,328] root - INFO - dropping rows on condition in train and test data
[2023-05-24 21:41:26,916] root - INFO - dropped rows on condition in train and test df train_df .shape = (202341, 5) , test_df.shape = (202341, 5)
[2023-05-24 21:41:26,917] root - INFO - Writting reprt in yaml file
[2023-05-24 21:41:26,918] root - INFO - report written into report.yaml
[2023-05-24 21:41:26,918] root - INFO - storing validation base_df into data validation artifacts
[2023-05-24 21:41:27,252] root - INFO - storing validation train data into data validation artifacts
[2023-05-24 21:41:27,740] root - INFO - storing validation test data into data validation artifacts
[2023-05-24 21:41:28,228] root - INFO - data validation is almost done
[2023-05-24 21:41:28,228] root - INFO - returning data_validation_artifact
[2023-05-24 21:41:28,243] root - INFO - ...................Starting data transfomration ..................
[2023-05-24 21:41:28,243] root - INFO - reading data from valid_feature_store_file...
[2023-05-24 21:41:28,341] root - INFO - reading data from valid_train_file.....
[2023-05-24 21:41:28,440] root - INFO - reading data from valid_test_file.....
[2023-05-24 21:41:28,539] root - INFO - handling InvoiceDate column in base_df
[2023-05-24 21:41:28,574] root - INFO - df[InvoiceDate] dtype != datetime, converting into datetime in                                 Description  Quantity          InvoiceDate  UnitPrice         Country
0        WHITE HANGING HEART T-LIGHT HOLDER         6  2010-12-01 08:26:00          2  United Kingdom
1                       WHITE METAL LANTERN         6  2010-12-01 08:26:00          3  United Kingdom
2       KNITTED UNION FLAG HOT WATER BOTTLE         6  2010-12-01 08:26:00          3  United Kingdom
3            RED WOOLLY HOTTIE WHITE HEART.         6  2010-12-01 08:26:00          3  United Kingdom
4              SET 7 BABUSHKA NESTING BOXES         2  2010-12-01 08:26:00          7  United Kingdom
...                                     ...       ...                  ...        ...             ...
202336           ALARM CLOCK BAKELIKE IVORY         4  2011-12-09 12:50:00          3          France
202337      CHILDRENS APRON SPACEBOY DESIGN         8  2011-12-09 12:50:00          1          France
202338                   SPACEBOY LUNCH BOX        12  2011-12-09 12:50:00          1          France
202339           CHILDRENS CUTLERY SPACEBOY         4  2011-12-09 12:50:00          4          France
202340         BAKING SET 9 PIECE RETROSPOT         3  2011-12-09 12:50:00          4          France

[202341 rows x 5 columns]
[2023-05-24 21:41:28,624] root - INFO - Created new columns Day, Month and year and dropped column InvoiceDate in                                 Description  Quantity  UnitPrice         Country  Day  Month  Year
0        WHITE HANGING HEART T-LIGHT HOLDER         6          2  United Kingdom    1     12    10
1                       WHITE METAL LANTERN         6          3  United Kingdom    1     12    10
2       KNITTED UNION FLAG HOT WATER BOTTLE         6          3  United Kingdom    1     12    10
3            RED WOOLLY HOTTIE WHITE HEART.         6          3  United Kingdom    1     12    10
4              SET 7 BABUSHKA NESTING BOXES         2          7  United Kingdom    1     12    10
...                                     ...       ...        ...             ...  ...    ...   ...
202336           ALARM CLOCK BAKELIKE IVORY         4          3          France    9     12    11
202337      CHILDRENS APRON SPACEBOY DESIGN         8          1          France    9     12    11
202338                   SPACEBOY LUNCH BOX        12          1          France    9     12    11
202339           CHILDRENS CUTLERY SPACEBOY         4          4          France    9     12    11
202340         BAKING SET 9 PIECE RETROSPOT         3          4          France    9     12    11

[202341 rows x 7 columns]
[2023-05-24 21:41:28,625] root - INFO - handling InvoiceDate in train and test data
[2023-05-24 21:41:28,631] root - INFO - df[InvoiceDate] dtype != datetime, converting into datetime in                                 Description  Quantity          InvoiceDate  UnitPrice         Country
0        WHITE HANGING HEART T-LIGHT HOLDER         6  2010-12-01 08:26:00          2  United Kingdom
1                       WHITE METAL LANTERN         6  2010-12-01 08:26:00          3  United Kingdom
2       KNITTED UNION FLAG HOT WATER BOTTLE         6  2010-12-01 08:26:00          3  United Kingdom
3            RED WOOLLY HOTTIE WHITE HEART.         6  2010-12-01 08:26:00          3  United Kingdom
4              SET 7 BABUSHKA NESTING BOXES         2  2010-12-01 08:26:00          7  United Kingdom
...                                     ...       ...                  ...        ...             ...
202336           ALARM CLOCK BAKELIKE IVORY         4  2011-12-09 12:50:00          3          France
202337      CHILDRENS APRON SPACEBOY DESIGN         8  2011-12-09 12:50:00          1          France
202338                   SPACEBOY LUNCH BOX        12  2011-12-09 12:50:00          1          France
202339           CHILDRENS CUTLERY SPACEBOY         4  2011-12-09 12:50:00          4          France
202340         BAKING SET 9 PIECE RETROSPOT         3  2011-12-09 12:50:00          4          France

[202341 rows x 5 columns]
[2023-05-24 21:41:28,679] root - INFO - Created new columns Day, Month and year and dropped column InvoiceDate in                                 Description  Quantity  UnitPrice         Country  Day  Month  Year
0        WHITE HANGING HEART T-LIGHT HOLDER         6          2  United Kingdom    1     12    10
1                       WHITE METAL LANTERN         6          3  United Kingdom    1     12    10
2       KNITTED UNION FLAG HOT WATER BOTTLE         6          3  United Kingdom    1     12    10
3            RED WOOLLY HOTTIE WHITE HEART.         6          3  United Kingdom    1     12    10
4              SET 7 BABUSHKA NESTING BOXES         2          7  United Kingdom    1     12    10
...                                     ...       ...        ...             ...  ...    ...   ...
202336           ALARM CLOCK BAKELIKE IVORY         4          3          France    9     12    11
202337      CHILDRENS APRON SPACEBOY DESIGN         8          1          France    9     12    11
202338                   SPACEBOY LUNCH BOX        12          1          France    9     12    11
202339           CHILDRENS CUTLERY SPACEBOY         4          4          France    9     12    11
202340         BAKING SET 9 PIECE RETROSPOT         3          4          France    9     12    11

[202341 rows x 7 columns]
[2023-05-24 21:41:28,686] root - INFO - df[InvoiceDate] dtype != datetime, converting into datetime in                                 Description  Quantity          InvoiceDate  UnitPrice         Country
0        WHITE HANGING HEART T-LIGHT HOLDER         6  2010-12-01 08:26:00          2  United Kingdom
1                       WHITE METAL LANTERN         6  2010-12-01 08:26:00          3  United Kingdom
2       KNITTED UNION FLAG HOT WATER BOTTLE         6  2010-12-01 08:26:00          3  United Kingdom
3            RED WOOLLY HOTTIE WHITE HEART.         6  2010-12-01 08:26:00          3  United Kingdom
4              SET 7 BABUSHKA NESTING BOXES         2  2010-12-01 08:26:00          7  United Kingdom
...                                     ...       ...                  ...        ...             ...
202336           ALARM CLOCK BAKELIKE IVORY         4  2011-12-09 12:50:00          3          France
202337      CHILDRENS APRON SPACEBOY DESIGN         8  2011-12-09 12:50:00          1          France
202338                   SPACEBOY LUNCH BOX        12  2011-12-09 12:50:00          1          France
202339           CHILDRENS CUTLERY SPACEBOY         4  2011-12-09 12:50:00          4          France
202340         BAKING SET 9 PIECE RETROSPOT         3  2011-12-09 12:50:00          4          France

[202341 rows x 5 columns]
[2023-05-24 21:41:28,734] root - INFO - Created new columns Day, Month and year and dropped column InvoiceDate in                                 Description  Quantity  UnitPrice         Country  Day  Month  Year
0        WHITE HANGING HEART T-LIGHT HOLDER         6          2  United Kingdom    1     12    10
1                       WHITE METAL LANTERN         6          3  United Kingdom    1     12    10
2       KNITTED UNION FLAG HOT WATER BOTTLE         6          3  United Kingdom    1     12    10
3            RED WOOLLY HOTTIE WHITE HEART.         6          3  United Kingdom    1     12    10
4              SET 7 BABUSHKA NESTING BOXES         2          7  United Kingdom    1     12    10
...                                     ...       ...        ...             ...  ...    ...   ...
202336           ALARM CLOCK BAKELIKE IVORY         4          3          France    9     12    11
202337      CHILDRENS APRON SPACEBOY DESIGN         8          1          France    9     12    11
202338                   SPACEBOY LUNCH BOX        12          1          France    9     12    11
202339           CHILDRENS CUTLERY SPACEBOY         4          4          France    9     12    11
202340         BAKING SET 9 PIECE RETROSPOT         3          4          France    9     12    11

[202341 rows x 7 columns]
[2023-05-24 21:41:28,736] root - INFO - handled InvoiceDate.......
[2023-05-24 21:41:28,736] root - INFO - .simple imputer in base_df..
[2023-05-24 21:41:28,752] root - INFO - handling simple imputer in train and test data
[2023-05-24 21:41:28,785] root - INFO - handled simple imputer.......
[2023-05-24 21:41:28,785] root - INFO - .........encoding objects column in base_df...........
[2023-05-24 21:41:30,941] root - INFO - handling encoding in train and test data
[2023-05-24 21:43:18,708] root - INFO - handled encoding.......
[2023-05-24 21:43:23,489] root - INFO - .........converting column.dtypes into int in base_df...........
[2023-05-24 21:43:27,048] root - INFO - converting column.dtypes into int in train and test data
[2023-05-24 21:43:27,561] root - INFO - converted column.dtypes into int.......
[2023-05-24 21:43:27,785] root - INFO -  ....... creating target columns .............
[2023-05-24 21:43:29,401] root - INFO - handling target column in train and test data
[2023-05-24 21:43:29,405] root - INFO - handled target column .......
[2023-05-24 21:43:33,970] root - INFO - base_df.head :    Quantity  UnitPrice  Day  Month  Year   STRIPEY MICE FELTCRAFT  ...  Norway  Portugal  Spain  Switzerland  United Kingdom  Total_price
0         6          2    1     12    10                        0  ...       0         0      0            0               1           12
1         6          3    1     12    10                        0  ...       0         0      0            0               1           18
2         6          3    1     12    10                        0  ...       0         0      0            0               1           18

[3 rows x 219 columns]
[2023-05-24 21:43:34,043] root - INFO - train_df.head :    Quantity  UnitPrice  Day  Month  Year   STRIPEY MICE FELTCRAFT  ...  Norway  Portugal  Spain  Switzerland  United Kingdom  Total_price
0         6          2    1     12    10                        0  ...       0         0      0            0               1           12
1         6          3    1     12    10                        0  ...       0         0      0            0               1           18
2         6          3    1     12    10                        0  ...       0         0      0            0               1           18

[3 rows x 219 columns]
[2023-05-24 21:43:34,113] root - INFO - test_df.head :    Quantity  UnitPrice  Day  Month  Year   STRIPEY MICE FELTCRAFT  ...  Norway  Portugal  Spain  Switzerland  United Kingdom  Total_price
0         6          2    1     12    10                        0  ...       0         0      0            0               1           12
1         6          3    1     12    10                        0  ...       0         0      0            0               1           18
2         6          3    1     12    10                        0  ...       0         0      0            0               1           18

[3 rows x 219 columns]
[2023-05-24 21:43:34,113] root - INFO - .......base_df shape ...(202341, 219)
[2023-05-24 21:43:34,114] root - INFO - .......train_df shape ..(202341, 219)
[2023-05-24 21:43:34,114] root - INFO - .......test_df shape ...(202341, 219)
[2023-05-24 21:43:34,114] root - INFO - data transformation is almost done.......
[2023-05-24 21:43:34,114] root - INFO - saving transformed data into data_transformation artifacts
